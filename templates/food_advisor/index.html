{% extends 'base.html' %}
{% load static %}

{% block title %}
    Home Page
{% endblock title %}

{% block content %}
<div class="container my-5">

    <!-- Search Bar -->
        <!-- Full-width Header with Background Image -->
        <div class="container my-5">
            <!-- Full-width Header with Background Image -->
            <div class="container my-5">
                <!-- Full-width Header with Background Image -->
                <div class="header-image" style="background: url('{% static 'images/search_back.png' %}') no-repeat center center; background-size: cover;">
                    <div class="overlay" style="background: rgba(0, 0, 0, 0.5); padding: 60px 0;">
                        <!-- Search Bar and Filter Dropdown -->
                        <div class="row">
                            <div class="col-md-10 col-lg-8 mx-auto text-center">
                                <form class="d-flex flex-column align-items-center w-100">
                                    
                                    <!-- Search Input and Button in-line -->
                                    <div class="d-flex w-100 mb-2">
                                        <input class="form-control flex-grow-1" type="search" placeholder="Search by restaurant name or restaurant type" aria-label="Search" name="search" required>
                                        <button class="btn btn-outline-success ml-2" type="submit">Search</button>
                                    </div>
            
                                    <!-- Filter Dropdown -->
                                    <div class="form-group w-100 mb-3">
                                        <select id="selectLeo" class="form-control" onchange="showSelectedValue()" style="width: 200px; margin: auto;">
                                            <option value="-1" disabled selected>Filter by Cuisine</option>
                                            <option value="0">Coffee</option>
                                            <option value="1">Chinese</option>
                                            <option value="2">Mexican</option>
                                            <option value="3">Italian</option>
                                            <option value="4">Clear Filters</option>
                                        </select>
                                    </div>
            
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

    <!-- Search Results Message -->
    {% if search %}
        <div class="text-center">
            {% if articles %}
                <h4>Results for "<span class="text-danger">{{ search }}</span>":</h4>
            {% else %}
                <h4>No results found for "<span class="text-danger">{{ search }}</span>".</h4>
            {% endif %}
            <hr>
        </div>
    {% endif %}

    <!-- Image Gallery Grid -->
    <div class="row row-cols-1 row-cols-md-3 g-4">
        {% for i in articles %}
            <div class="col">
                <div class="card h-100 shadow-sm">
                    <img src="{{ i.avatar.url }}" class="card-img-top" alt="{{ i.title }}">
                    <div class="card-body">
                        <h5 class="card-title">{{ i.title }}</h5>
                        <p class="card-text">{{ i.body|slice:'100' }}...</p>
                    </div>
                    <div class="card-footer bg-white border-top-0">
                        <div class="tags">
                            {% for tag in i.tags.all %}
                                <span class="badge badge-info">{{ tag }}</span>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        {% empty %}
            <!-- Columns for static images when there are no articles -->
            <div class="col">
                <img src="{% static 'images/1.jpg' %}" alt="Restaurant Image 1" class="img-fluid" style="margin-bottom: 20px;">
            </div>
            <div class="col">
                <img src="{% static 'images/1.jpg' %}" alt="Restaurant Image 2" class="img-fluid" style="margin-bottom: 20px;">
            </div>
            <div class="col">
                <img src="{% static 'images/1.jpg' %}" alt="Restaurant Image 3" class="img-fluid" style="margin-bottom: 20px;">
            </div>
        {% endfor %}
    </div>

    <script>
        function showSelectedValue(){
            var foodType = document.getElementById("selectLeo");
            var selectedText = foodType.options[foodType.selectedIndex].text;
            var newUrl = "{% url 'index' %}?search=" + selectedText;

            window.location.href = newUrl;
        }
    </script>

</div>
{% endblock content %}
